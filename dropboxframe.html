<html>
<head>
<script src="https://unpkg.com/dropbox/dist/Dropbox-sdk.min.js"></script>
<script>
var access_token = "";
var CLIENT_ID = '6blxv6kb9rkek2e';

function isAuthenticated() {
   const queryString = window.location.search;
   const urlParams = new URLSearchParams(queryString);
   access_token = urlParams.get('ACCESS_TOKEN');

   return (access_token != undefined && access_token.length > 0);
}

function authenticatePage() {
   if (isAuthenticated()) {
      alert(access_token);
   } else {
      var dbx = new Dropbox.Dropbox({ clientId: CLIENT_ID });
      var authUrl = dbx.auth.getAuthenticationUrl('https://prowler22.github.io/index.html')
        .then((authUrl) => {
           //location.href = authUrl;
           alert (authUrl);
        })
   }
}
</script>
</head>
<body onload="authenticatePage()">
</body>
</html>